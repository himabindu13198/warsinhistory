# Results

In this chapter, we gave a summary of findings for our analysis. In gereneal, there are three subsections, which are general exploratory data visualization, focous on World War I and World War II, and linkage to external indicative statistics such as GDP per capita, population, and military expenditure. For all plots, colors are color-vision-deficiency-friendly by using tested palettes.


```{r, include=FALSE}
# mute all warnings and messgaes, and set codes not shown
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)

# install and load the libraries
if(!require("ggplot2")) { install.packages("ggplot2"); library("ggplot2")}
if(!require("dplyr")) { install.packages("dplyr"); library("dplyr")}
if(!require("tidyverse")) { install.packages("tidyverse"); library("tidyverse")}
if(!require("maps")) { install.packages("maps"); library("maps")}
if(!require("GGally")) { install.packages("GGally"); library("GGally")}
if(!require("RColorBrewer")) { install.packages("RColorBrewer"); library("RColorBrewer")}
if(!require("parcoords")) { install.packages("parcoords"); library("parcoords")}
if(!require("gridExtra")) { install.packages("gridExtra"); library("gridExtra")}
if(!require("cowplot")) { install.packages("cowplot"); library("cowplot")}
if(!require("plotly")) { install.packages("plotly"); library("plotly")}
if(!require("vcd")) { install.packages("vcd"); library("vcd")}
if(!require("ggmosaic")) { install.packages("ggmosaic"); library("ggmosaic")}
if(!require("ggthemes")) { install.packages("ggthemes"); library("ggthemes")}
if(!require("viridis")) { install.packages("viridis"); library("viridis")}
```


## General EDAV

### Number of wars  by type

To begin with our analysis, we first explored **what types of wars happened most frequently** as the original war data sets are divided by 4 war types: intra-state, inter-state, extra-state, and non-state wars. We observe from *Figure 1* that intra-state wars happened the most with over 400 occurences throghout history, followed by inter-state wars, then extra-state wars with non-state wars being the least common war type. Considering that the scale of inter-state wars is usually larger than scale of intra-state wars, the larger number of occurences of intra-state wars is expected and non-state wars are the least common with least occurrences. In addition, according to *Figure 2* and definitions of wars types, we found that:  

* Within extra-state wars, two thirds of extra-state wars are imperial and one third of extra-state wars are colonial.
* Inter-state wars are not divided into further categories.
* More than half of the intra-state wars are civil wars for central control, while 40% are civil wars for local issues. In terms of the remaining intra-state wars, there are approximately twice number of intercommunal wars than regional internal wars.
* Among all non-state wars, the majority of wars happened in non-state territories while little were cross state borders (in fact only one war was across state borders).

```{r fig.width=5}
# import data
inter_state <- read.csv('data/raw/Inter-StateWarData_v4.0.csv')
intra_state <- read.csv('data/raw/Intra-StateWarData_v4.1.csv')
extra_state <- read.csv('data/raw/Extra-StateWarData_v4.0.csv')
non_state <- read.csv('data/raw/Non-StateWarData_v4.0.csv')

# Intra state wars are further categorized into 3 types as follows
Civil_intra_state <- intra_state %>% filter(WarType==4 | WarType==5)
Regional_internal_intra_state <- intra_state %>% filter(WarType==6)
Intercommunal_intra_state <-intra_state %>% filter(WarType==7)

intra <- intra_state %>% 
  select(WarNum, WarName, WarType) %>% 
  mutate(Type="Intra-state") %>%
  mutate(SubType=ifelse(WarType==4, "4: Intra-Civil war for central control",
                        ifelse(WarType==5, "5: Intra-Civil war over local issues",
                               ifelse(WarType==6, "6: Intra-Regional internal","7: Intra-Intercommunal"))))

inter <- inter_state %>% 
  select(WarNum, WarName, WarType) %>% 
  mutate(Type="Inter-state") %>%
  mutate(SubType="1: Inter")

extra <- extra_state %>% 
  select(WarNum, WarName, WarType) %>% 
  mutate(Type="Extra-state") %>%
  mutate(SubType=ifelse(WarType==2, "2: Extra-Colonial", "3: Extra-Imperial"))

non <- non_state %>% 
  select(WarNum, WarName, WarType) %>% 
  mutate(Type="Non-state") %>%
  mutate(SubType=ifelse(WarType==8, "8: Non-In nonstate territory", "9: Non-Across state borders"))

total <- rbind(intra, inter, extra, non)
total$Type<- as.factor(total$Type)
total$SubType<- as.factor(total$SubType)

total_stacked <- total %>%
  group_by(Type, SubType) %>%
  summarise(count = n())
```



```{r}
# http://www.sthda.com/english/wiki/wiki.php?id_contents=7930#add-a-common-legend-for-multiple-ggplot2-graphs
get_legend<-function(myggplot){
  tmp <- ggplot_gtable(ggplot_build(myggplot))
  leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
  legend <- tmp$grobs[[leg]]
  return(legend)
}

theme1 = theme(
  plot.title = element_text(hjust = 0.5, size=14),
  axis.text.y = element_text(size = 12),
  axis.text.x = element_text(size = 11),
  axis.title = element_text(size = 13),
  legend.text=element_text(size = 9.5),
  legend.title=element_text(size = 10.5))

p1<- ggplot(total_stacked, aes(y=count, x=Type, fill=SubType)) + 
  geom_bar(stat="identity") + 
  ggtitle("Figure 1: Stacked bar chart\nof war types") + 
  theme1 + 
  scale_y_continuous(limits=c(0,450)) + 
  scale_colour_colorblind() 

p2 <- ggplot(total_stacked, aes(y=count, x=Type, fill=SubType)) + 
  geom_bar(position="fill", stat="identity") + 
  ylab("percent") +
  ggtitle("Figure 2: Percent stacked bar chart\nof war types") + 
  theme(legend.position = "none") +
  theme1 + 
  scale_y_continuous(labels = scales::percent_format()) + 
  scale_colour_colorblind()

legend <- get_legend(p1)

p1 <- p1 + theme(legend.position="none")

lankPlot <- ggplot() + 
  geom_blank(aes(1,1)) + 
  cowplot::theme_nothing()
```



```{r fig.width=10.7, fig.height=6.5}
grid.arrange(p1, p2, legend,
             ncol=3, nrow = 1, 
             widths = c(2.5,2.5,1.5), 
             heights = c(4))
```


### Number of wars by state

```{r}
country_codes <- read.csv('data/raw/COW country codes.csv')
# Intra-state:
# if a war appears with two sides, then:
#   * if CcodeA is valid, add new row (WarNum, WarName, WarType, ccode=CcodeA) to data frame
#   * if CcodeB is valid, add new row (WarNum, WarName, WarType, ccode=CcodeB) to data frame

dfa2_intra_sidea <- intra_state %>% 
  select(WarNum, WarName, WarType, CcodeA, SideA, SideADeaths) %>%
  mutate(Type = "Intra-state", BatDeath = SideADeaths) %>%
  filter(CcodeA != -8) %>%
  mutate(StateName = SideA) %>%
  select(-CcodeA, -SideA, -SideADeaths)

dfa2_intra_sideb <- intra_state %>% 
  select(WarNum, WarName, WarType, CcodeB, SideB, SideBDeaths) %>%
  mutate(Type = "Intra-state", BatDeath = SideBDeaths) %>%
  filter(CcodeB != -8) %>%
  mutate(StateName = SideB) %>%
  select(-CcodeB, -SideB, -SideBDeaths)

dfa2_intra <- rbind(dfa2_intra_sidea, dfa2_intra_sideb)
dfa2_intra <- dfa2_intra[order(dfa2_intra$WarNum), ]

# Inter-state:
#  * if ccode is valid, add new row (WarNum, WarName, Type, ccode) to data frame
dfa2_inter <- inter_state %>%
  select(WarNum, WarName, WarType, StateName, BatDeath) %>%
  mutate(Type = "Inter-state")

# Extra-state:
#   * there are no war with both SideA and SideB existing, which means each row represents a war with one side record
#   * we can then safely add BatDeath and NonStateDeaths as total BatDeath
dfa2_extra_both_side <- extra_state %>% 
  select(WarNum, WarName, WarType, ccode1, SideA, ccode2, SideB, BatDeath) %>%
  filter(ccode1 != -8 & ccode2 != -8)

#nrow(dfa2_extra_both_side)

dfa2_extra_sidea <- extra_state %>% 
  select(WarNum, WarName, WarType, ccode1, SideA, BatDeath) %>%
  mutate(Type = "Extra-state")  %>%
  filter(ccode1 != -8) %>%
  mutate(StateName = SideA) %>%
  select(-ccode1, -SideA)

dfa2_extra_sideb <- extra_state %>% 
  select(WarNum, WarName, WarType, ccode2, SideB, BatDeath) %>%
  mutate(Type = "Extra-state")  %>%
  filter(ccode2 != -8) %>%
  mutate(StateName = SideB) %>%
  select(-ccode2, -SideB)

dfa2_extra <- rbind(dfa2_extra_sidea, dfa2_extra_sideb)

# Non-state: these wars are not about countries or states, and thus we don't take them into consideration. 
```



Apart from which war types were the most common, it also seems interesting to explore what states participated most frequently in the wars, whether their participation was "active"(they were initiators of the wars) or "passive"(they were not initiators of the wars). For this question, we did not take non-state wars into consideration because non-state wars are not about states or countries, as implied from the name "non-state". For *Figure 3*, after combining intra-state, extra-state and inter-state wars by state name, there are 160 states (rows) in total and we picked the first 80 states that were ever involved in the wars most frequently, to make cleveland plots more clear. Based on *Figure 3*, United Kingdom, France, China, Russia, and Ottoman Empire were involved in the wars more frequently, which is not a surprising finding considering these states' history and size. In addition, the numbers of wars in which United Kingdom and France participated are far more than that of the remaining states.


```{r  fig.height=11, fig.width=7}
dfa2 <- rbind(dfa2_extra, dfa2_inter, dfa2_intra) %>%
  group_by(StateName) %>%
  summarise(Count = n())
# nrow(dfa2) 
# There are 160 countries in total

dfa2.1 <- dfa2[order(-dfa2$Count), ][1:80, ]

theme_dotplot <- theme_bw(13) + 
  theme(axis.text.x = element_text(size = rel(.9)),
        axis.text.y = element_text(size = rel(.85)),
        panel.grid.major.y = element_line(size = 0.5),
        panel.grid.minor.x = element_blank(),
        plot.title = element_text(hjust = 0.5, size = 12))


ggplot(dfa2.1, aes(x = Count, y = fct_reorder(StateName, Count))) +
  geom_point(color = "blue", size = 1.5) + 
  xlab("Number of Wars") +
  ylab("State Name") +
  ggtitle("Figure 3: Number of wars for each state") +
  scale_x_continuous(breaks = seq(0,87,3)) + 
  scale_colour_colorblind()+ 
  theme_dotplot 
```


```{r}
theme2 = theme(
  plot.title = element_text(hjust = 0.5, size=15),
  axis.text.y = element_text(size = 11.5),
  axis.text.x = element_text(size = 11.5),
  axis.title = element_text(size = 13))

dfa2_extra.g <- dfa2_extra %>%
  group_by(StateName) %>%
  summarise(Count = n())

dfa2_extra.g <- dfa2_extra.g[order(-dfa2_extra.g$Count), ][1:40, ]

b1 <- ggplot(dfa2_extra.g, aes(x = reorder(StateName, Count), y = Count)) +
  geom_bar(stat="identity", color = "grey50", fill = "lightblue") +
  xlab("State Name") +
  ylab("Number of Wars") +
  coord_flip() + 
  ggtitle("Figure 4: Bar chart of number of\nextra-state wars\nfor each state") + 
  scale_fill_manual(values=cbbPalette)+
  theme2

dfa2_intra.g <- dfa2_intra %>%
  group_by(StateName) %>%
  summarise(Count = n())

dfa2_intra.g <- dfa2_intra.g[order(-dfa2_intra.g$Count), ][1:40, ]

b2 <- ggplot(dfa2_intra.g, aes(x = reorder(StateName, Count), y = Count)) +
  geom_bar(stat="identity", color = "grey50", fill = "lightblue") +
  xlab("State Name") +
  ylab("Number of Wars") + 
  coord_flip() + 
  ggtitle("Figure 5: Bar chart of number of\nintra-state wars\nfor each state") +
  theme2

dfa2_inter.g <- dfa2_inter %>%
  group_by(StateName) %>%
  summarise(Count = n())

dfa2_inter.g <- dfa2_inter.g[order(-dfa2_inter.g$Count), ][1:40, ]

b3 <- ggplot(dfa2_inter.g, aes(x = reorder(StateName, Count), y = Count)) +
  geom_bar(stat="identity", color = "grey50", fill = "lightblue") +
  xlab("State Name") +
  ylab("Number of Wars") + 
  coord_flip() +
  ggtitle("Figure 6: Bar chart of number of\ninter-state wars\nfor each state") +
  theme2
```


When we look into each war type, there is new information based on *Figure 4*, *Figure 5*, and *Figure 6*. United Kingdom only appeared to be most involved in extra-state wars, which is resonable in terms of its colonization before 19th century. France and Spain rank second and thrid for participating in extra-state wars as states that developed in the First Industrial Revolution and seeked colonial expansion. China has most intra-state wars with Ottoman Empire and Russia rank as second and third, which may be related to state's larger population and longer history. Finally, France, United States of America, and United Kingkom have been involved in most inter-state wars. There is another point worth notice that are much more intra-state and inter-state wars than extra-state wars for each state, corresponding to the findings in *Figure 1*.


```{r fig.height=9, fig.width=15}
grid.arrange(b1, b2, b3,
             ncol=3, nrow = 1, 
             widths = c(2,2,2))
```




### Number of war deaths



A part we can never ignore about wars is the number of deaths caused. For this project, we only demonstrate the number of battle deaths, the battle-related combatant fatalities suffered by the state. 


```{r}
dfa4_non <- non_state %>%
  select(WarNum, WarName, WarType, TotalCombatDeaths) %>%
  mutate(Type = "Non-state", BatDeath = TotalCombatDeaths) %>%
  select(-TotalCombatDeaths)

dfa4_inter <- dfa2_inter %>% 
  select(-StateName)

dfa4_intra <- dfa2_intra %>% 
  select(-StateName)

dfa4_extra <- dfa2_extra %>% 
  select(-StateName)

dfa4 <- rbind(dfa4_extra, dfa4_inter, dfa4_intra, dfa4_non) %>%
  mutate(BatDeath2 = as.numeric(sub(",", "", BatDeath, fixed = TRUE))) %>%
  mutate(BatDeath3 = ifelse(BatDeath2 == -9, NA, BatDeath2)) %>%
  filter(BatDeath3 != 0) %>% # remove NA and 0 number of deaths
  group_by(WarType) %>%
  summarise(WarDeath=sum(BatDeath3))
```


We first explored which war type caused the most number of battle deaths and it can be observed from *Figure 7* the war type is **inter-state** wars, with a number over 30 million standing out among all other types.  


```{r}
plot_ly(dfa4, x = ~WarType, y = ~WarDeath, type = "bar") %>%
  layout(yaxis = list(title = 'Number of deaths'),
         xaxis = list(title = 'War type'),
         title = 'Figure 7: Interactive bar chart of number of deaths for each war type')
```


Now please think of one war in history that you believe caused most battle deaths and scroll down to *Figure 8* to check your answer. 

Notice that we took log of the number of battle deaths due to the large number. The two wars with most humanity losses are World War II and World War I and the number of deaths for World War II (over 16.5 million) is almost twice of the number for World War I (about 8 million). This might be one of the reasons that these are the two most famous wars in history. Another war causing a large number of deaths is Iran-Iraq war (about 1.5 million), but an obvious break of link between world wars and other wars can be seen clearly.  



```{r fig.height=7, fig.width=6.5}
dfa5 <- rbind(dfa4_extra, dfa4_inter, dfa4_intra, dfa4_non) %>%
  mutate(BatDeath2 = as.numeric(sub(",", "", BatDeath, fixed = TRUE))) %>%
  mutate(BatDeath3 = ifelse(BatDeath2 == -9, NA, BatDeath2)) %>%
  filter(BatDeath3 != 0) %>% # remove NA and 0 number of deaths
  group_by(WarType, WarName) %>%
  summarise(SumDeath=sum(BatDeath3))

dfa5.4 <- dfa5 %>%
  filter(SumDeath != 0)

dfa5.4 <- dfa5.4[order(-dfa5.4$SumDeath), ][1:40, ]

ggplot(dfa5.4, aes(x = log(SumDeath), y = fct_reorder(WarName, SumDeath))) +
  geom_point(color = "blue", size = 1.5) + 
  xlab("Log of number of battle deaths") +
  ylab("War name") +
  ggtitle("Figure 8: Number of battle deaths\nfor each war") +
  scale_x_continuous(breaks = seq(0,20,0.5)) + 
  theme_dotplot
```


Here is another question from the perspective of each state: what states had most losses of human lives due to the war? According to *Figure 9*, three states lost far more human lives than other states, which are USSR, Germany, and China. Russia ranked fourth, Japan is the fifth with France as the sixth. Russia appeared here simultaneously with USSR since we treated USSR (WWI) and Russia (WWII) as separate states in that they existed in different periods. 



```{r fig.height=8, fig.width=6.5}
dfa8 <- rbind(dfa2_inter, dfa2_intra, dfa2_extra) %>%
  mutate(BatDeath2 = as.numeric(sub(",", "", BatDeath, fixed = TRUE))) %>%
  mutate(BatDeath3 = ifelse(BatDeath2 == -9, NA, BatDeath2)) %>%
  group_by(StateName) %>%
  summarise(CountryBatDeath=sum(BatDeath3, na.rm = TRUE))

dfa8.1 <- dfa8 %>%
  filter(CountryBatDeath != 0)

dfa8.1 <- dfa8.1[order(-dfa8.1$CountryBatDeath), ][1:60, ]

ggplot(dfa8.1, aes(x = log(CountryBatDeath), y = fct_reorder(StateName, CountryBatDeath))) +
  geom_point(color = "blue", size = 1.5) + 
  xlab("Log of number of battle deaths") +
  ylab("State name") +
  ggtitle("Figure 9: Number of battle deaths for each state") +
  scale_x_continuous(breaks = seq(0,20,0.5)) + 
  theme_dotplot
```



Germany's high ranking is unexpected considering its population but also makes sense because Germany is one of the members on both World War I Alliance and World War II Axis Powers. Russia, Japan, and France showed up close in a group in the cleveland plot in addition to the first three states. On the other hand, the majority of states suffered losses of human lives in wars with a number less than 1 million.  



### Correlation between wars and death counts


From the previous exploraty data visualizations, it is reasonable to infer there should be a correlation between the number of wars and number of battle deaths for states. As a result, in this part we explored in more details for this question of the relationship between two categorical variables.  


```{r}
dfa9 <- merge(dfa2, dfa8, by="StateName") %>%
  filter(CountryBatDeath != 0)

sp <- ggplot(dfa9, aes(y=log(CountryBatDeath), x=Count)) + 
  geom_point(aes(text=StateName), color = "blue") +
  xlab("Number of wars") +
  ylab("Log of number of total battle deaths") + 
  ggtitle("Figure 10: Number of battle deaths vs. Number of wars\nfor each state") + 
  theme(plot.title = element_text(hjust = 0.5, size=12))

ggplotly(sp, tooltip = c("text"))
```


There seems to be a very week positive correlation between number of wars a country participated in and the number of total battle deaths in those wars based on *Figure 10* and *Figure 11*. While France and UK participated in the most wars, with France participating in more than 60 wars and UK participating in more than 80 wars, their battle deaths are still lower than Germany, USSR, China and Russia, even though those countries/states are in way fewer wars. While France and Japan have around the same total battle deaths, those deaths were from fewer than 20 wars for Japan while for France, those deaths were from more than 60 wars. Germany and USSR participated in under 20 wars but their total battle deaths were higher than any other countries.



```{r}
theme_heatmap <- theme_bw(15) + 
  theme(axis.text.x = element_text(size = rel(.8)),
        axis.text.y = element_text(size = rel(.8)),
        axis.title.x = element_text(size = rel(.8)),
        axis.title.y = element_text(size = rel(.8)),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "transparent"), 
        plot.background = element_rect(fill = "transparent", color = NA),
        plot.title = element_text(hjust = 0.5, size = 10),
        legend.text = element_text(size = rel(.6)),
        legend.title = element_text(size = rel(.6)))

ggplot(dfa9, aes(y=log(CountryBatDeath), x=Count)) +
  ggtitle("Figure 11: Hexagonal heatmap of bin counts") + 
  geom_hex(binwidth=c(4,1), alpha = 0.9) + 
  geom_point(size=0.8) +
  xlab("Number of wars") +
  ylab("Log of number of total battle deaths") + 
  scale_fill_gradient(low = "#cccccc", high = "#09005F", trans = "log10") + 
  theme_heatmap 
```



### Inter-state wars: Correlation between initiators and winners


We might think more initiators lose the war they initiated (thinking about Gernaby in WWI and WWII) and to deal with this initiative, we made the mosaic plot *Figure 12*. First of all, there are fewer initiators than non-initiators and there are slightly more winners than losers for all wars. In addition, few wars ended up as tied. For winners of a war, there are more non-initiators. For losers of a war, a higher percentage of states are non-initiators. If more initiators truly lose the war than non-initiators, we would expect a higher percentage of losers to be initiators which is the opposite case. 



```{r}
dfa7 <- inter_state %>% 
  select(WarNum, WarName, WarType, ccode, StateName, Side, Initiator, Outcome, BatDeath) %>%
  filter(Outcome == 1 | Outcome == 2 | Outcome == 3) %>%
  mutate(Initiator = as.factor(Initiator), Outcome = as.factor(Outcome), BatDeath = as.numeric(BatDeath)) 

lnames <- list(Initiator = c("Yes", "No"), Outcome = c("Winner", "Loser", "Tied"))

vcd::mosaic(Initiator ~ Outcome, 
            data = dfa7,
            set_labels=lnames, 
            main = "Figure 12: Mosaic plot between Outcome versus Initiator",
            shade=T)
```



More specially, according to *Figure 13*, France initiated the most inter-state wars (8 wars), while U.S., Russia and Japan initiated the second most inter-state wars (7 wars). Syria, Thailand, Saudi Arabia, South Africa and Uganda initiated 0 inter-state wars. 

There seems to be a positive correlation between the number of wars a country is in and the number of wars it initiated. France initiated the most inter-state wars and were in the most number of wars. Syria, Thailand, Saudi Arabia, South Africa and Uganda initiated no inter-state wars and are among the countries that participated in the least number of wars.



```{r}
dfa3.1 <- dfa7 %>% 
  group_by(StateName) %>%
  filter(Initiator == 1) %>%
  summarise(NumInit = n())

dfa3.2 <- dfa7 %>%
  group_by(StateName) %>%
  summarise(NumPart = n())

dfa3 <- merge(dfa3.1, dfa3.2, by = "StateName", all = TRUE)

sp2 <- ggplot(dfa3, aes(y=NumPart, x=NumInit)) + 
  geom_point(aes(text=StateName), color = "blue") +
  xlab("Number of initiating wars") +
  ylab("Number of wars") + 
  ggtitle("Figure 13: Number of initiating wars versus Number of wars") + 
  theme(plot.title = element_text(hjust = 0.5, size=12))

ggplotly(sp2, tooltip = c("text"))
```



Parallel coordinate plots can be used to visualize outliers in a dataset. In the below parallel coordinate plot, we can see that USSR seems to be an outlier: it has way higher battle deaths than every other country that participated in the war. There seems to be a trend for non-initiators to have lower battle deaths, however USSR doesn't follow this trend. USSR was not an initiator but has the highest number of battle deaths.


```{r}
dfa6 <- inter_state %>% select(Initiator, Outcome, BatDeath) %>% mutate(Initiator = as.factor(Initiator))

parcoords(dfa6, 
          rownames=FALSE,
          brushMode="1D-axes",
          reorderable=TRUE,
          queue=TRUE,
          alphaOnBrushed=0.5,
          color=list(colorBy="Initiator"),
          withD3=TRUE)
```

Parallel coordinate plots can be used to visualize outliers in a dataset. In the above parallel coordinate plot, we can see that USSR seems to be an outlier: it has way higher battle deaths than every other country that participated in the war. There seems to be a trend for non-initiators to have lower battle deaths, however USSR doesn't follow this trend. USSR was not an initiator but has the highest number of battle deaths.


## World War I and World War II

In *Figure 8*, we notice the two wars with most number of deaths are World War I and World War II, which correspond to the two most famous wars in history all over the world. Therefore, we decided to focus in there two world wars for the following analysis.  



```{r}
df1=inter_state%>%group_by(StateName)%>%summarise(total_deaths=sum(BatDeath))

world <- map_data("world")

df1 <- df1 %>%
  ## Recode certain entries
  mutate(StateName = recode(str_trim(StateName), 
                            "United States of America" = "USA",
                            "United Kingdom" = "UK",
                            "China (PRC)"="China",
                            "Taiwan (ROC)"="Taiwan",
                            "Yemen Arab Republic"="Yemen"))

df1$total_deaths=df1$total_deaths/1000

ggplot(df1, aes(map_id = StateName)) + 
  geom_map(aes(fill = total_deaths), map = world) +
  expand_limits(x = world$long, y = world$lat) +
  borders(database = "world", 
          regions = ".", 
          fill = NA,
          colour = "grey50", 
          xlim = NULL, 
          ylim = NULL) +
  scale_fill_distiller(type = "seq", 
                       palette = "Spectral",
                       direction = -1,
                       limits = c(min(df1$total_deaths), max(df1$total_deaths)), 
                       na.value = "white", 
                       name = "Number of deaths in thousands") +
  coord_fixed(1.3) +
  labs(title = "Figure 15: Deaths of inter-state wars by states (1816-2007)", x=" ", y=" ")
```



Based on *Figure 15*, Germany, China and Russia are the three countries with the most number of total deaths in all inter-state wars(in that same order). South American Countries, Canada and Australia are among the countries with the least number of total battle deaths. 




```{r}
# maps
world <- map_data("world") %>%
  mutate(region = recode(str_trim(region), 
                            "Russia" = "USSR",
                            "Georgia" = "USSR",
                            "Ukraine" = "USSR", 
                            "Moldova" = "USSR", 
                            "Belarus" = "USSR", 
                            "Armenia" = "USSR", 
                            "Azerbaijan" = "USSR", 
                            "Kazakhstan" = "USSR", 
                            "Uzbekistan" = "USSR", 
                            "Turkmenistan" = "USSR", 
                            "Kyrgyzstan" = "USSR", 
                            "Tajikistan" = "USSR",
                         "Bosnia and Herzegovina" = "Yugoslavia",
                         "Croatia" = "Yugoslavia",
                         "Macedonia" = "Yugoslavia",
                         "Montenegro" = "Yugoslavia",
                         "Serbia" = "Yugoslavia",
                         "Slovenia" = "Yugoslavia", 
                         "Czech Republic" = "Austria-Hungary",
                         "Hungary" = "Austria-Hungary",
                         "Montenegro" = "Austria-Hungary",
                         "Poland" = "Austria-Hungary",
                         "Serbia" = "Austria-Hungary",
                         "Slovakia" = "Austria-Hungary",
                         "Slovenia" = "Austria-Hungary",
                         "Ukraine" = "Austria-Hungary"))


Russia <- map_data("world") %>% filter(region == "Russia")
world <- rbind(world, Russia)
write.csv(world, "data/clean/world_updated.csv")
```


```{r}
# world_war1:: Years: 1914-1918
world_war1=inter_state%>%filter(WarName=='World War I')
world_war1$StateName=as.character(world_war1$StateName)

world_war1 <- world_war1 %>%
  ## Recode certain entries
  mutate(StateName = recode(str_trim(StateName), 
                            "United States of America" = "USA",
                            "United Kingdom" = "UK"))

world_war1 <- world_war1 %>% mutate(number_of_days = as.Date(with(world_war1, paste(EndYear1, EndMonth1, EndDay1,sep="-")), "%Y-%m-%d")-as.Date(with(world_war1, paste(StartYear1, StartMonth1, StartDay1,sep="-")), "%Y-%m-%d"))

world_war1$number_of_days <- as.numeric(world_war1$number_of_days )

# world_war2:: Years: 1939-1945
world_war2=inter_state%>%filter(WarName=='World War II')
world_war2$StateName=as.character(world_war2$StateName)

# maps
world_war2 <- world_war2 %>%
  ## Recode certain entries
  mutate(StateName = recode(str_trim(StateName), 
                            "United States of America" = "USA",
                            "United Kingdom" = "UK"))


world_war21 <- world_war2 %>% filter(StartYear2 !=-8) 

world_war21=world_war21%>%  mutate(number_of_days = as.Date(with(world_war21, paste(EndYear1, EndMonth1, EndDay1,sep="-")), "%Y-%m-%d")-as.Date(with(world_war21, paste(StartYear1, StartMonth1, StartDay1,sep="-")), "%Y-%m-%d")+as.Date(with(world_war21, paste(EndYear2, EndMonth2, EndDay2,sep="-")), "%Y-%m-%d")-as.Date(with(world_war21, paste(StartYear2, StartMonth2, StartDay2,sep="-")), "%Y-%m-%d"))

world_war22 <- world_war2 %>% filter(StartYear2 ==-8)

world_war22=world_war22 %>%  mutate(number_of_days = as.Date(with(world_war22, paste(EndYear1, EndMonth1, EndDay1,sep="-")), "%Y-%m-%d")-as.Date(with(world_war22, paste(StartYear1, StartMonth1, StartDay1,sep="-")), "%Y-%m-%d"))

world_war2=rbind(world_war21,world_war22)

world_war2$number_of_days <- as.numeric(world_war2$number_of_days)


world_wars <- rbind(world_war1, world_war2)

world_wars$WarName <- as.factor(world_wars$WarName)

write_csv(world_wars, "data/clean/world_wars.csv")
```

```{r eval=FALSE}
world2 <- map_data("world") %>% filter(region == "Bosnia and Herzegovina")
for (val in unique(world_war1$StateName) ) {
  if (!(val %in%  unique(world$region)))  {print(val)}}
```




```{r fig.width=12, fig.height=5}
ggplot(world_wars, aes(map_id = StateName)) + 
  geom_map(aes(fill = BatDeath), map = world, col = "white") +
  expand_limits(x = world$long, y = world$lat) +
  scale_fill_distiller(name = "Number of battle deaths", palette = "Spectral") +
  borders(database = "world", 
          regions = ".", 
          fill = NA,
          colour = "grey50", 
          xlim = NULL, 
          ylim = NULL) +
  labs(title = "Figure 16: Battle deaths for WWI versus WWII", 
       x = "Longitude", 
       y = "Latitude") +
  facet_wrap(~WarName, scales = "free", ncol = 2) +
  theme(plot.title = element_text(hjust = 0.5, size = 16),
        strip.text.x = element_text(size = 8),
        legend.position="top",
        legend.key.width=unit(1.5,"cm"))
```


The state with the most death in both wars is USSR and its battle deaths more than tripled in WWII: it had 2 million battle deaths during WWI and more than 6 million battle deaths during WWII.  The overall battle death level is higher during WWII than WWI. We can observe that a lot more countries participated in WWII than WWI. For the countries that participated in both wars, all of them suffered more battle deaths in WWII than in WWI. 



```{r fig.width=12, fig.height=5}
ggplot(world_wars, aes(map_id = StateName)) + 
  geom_map(aes(fill = number_of_days), map = world, col = "white") +
  expand_limits(x = world$long, y = world$lat) +
  scale_fill_distiller(name = "Number of battle deaths", palette = "Spectral") +
  borders(database = "world", 
          regions = ".", 
          fill = NA,
          colour = "grey50", 
          xlim = NULL, 
          ylim = NULL) +
  labs(title = "Figure 17: Number of war days for WWI versus WWII", 
       x = "Longitude", 
       y = "Latitude") +
  facet_wrap(~WarName, scales = "free", ncol = 2) +
  theme(plot.title = element_text(hjust = 0.5, size = 16),
        strip.text.x = element_text(size = 8),
        legend.position="top",
        legend.key.width=unit(1.5,"cm"))
```


While the state with the most battle deaths in both wars is USSR, it is not the country that stayed in the war the longest. For most countries that participated in both wars, the number of days they were in the war increased from WWI to WWI. Some European countries such as France were in the WWII for a shorter amount of time than WWI while Germany stayed in WWII longer than it stayed in WWI. 


## External statistics

Wars do not only result in a large number of casualties but also impose effects on a wide range of aspects such as GDP pertica, population, living standards of cilvilians, military expensiture, education, etc. Again, we only focus on states like Japan, Russia, Germany, China, United Kingdom, France that participated both in WWI and WWII.

### World War I

#### Real GDP per capita and population



```{r}
#read in data
gdp_pop=read.csv('data/raw/Raw_GDP_Pop_Data.csv')
#world_war1:: Years: 1914 -1918
#Let's look at 1910 - 1920 and see what effect WW1 had on real GDP per capita and population
WW1=gdp_pop%>%filter(year>= 1910 & year <=1922)
#world_war2:: Years: 1939 -1945
WW2 = gdp_pop%>%filter(year>= 1935 & year <=1949)
```

```{r warning=FALSE}
theme3 = theme(plot.title = element_text(hjust = 0.5, size=13))

WW1_subset = WW1%>%filter(country %in% c("United States", "Former USSR", "United Kingdom", "France", "Germany", "Japan"))
#WW1_subset <- na.omit(WW1_subset)
p1 <- ggplot(WW1_subset, aes(year, rgdpnapc, color = country),frequency =1) + geom_line() +
    ggtitle("Figure 18: 1910 -1920 Real GDP Per Capita in 2011 US dollar") +
    scale_x_continuous(breaks=seq(1910, 1922, 1)) +
    scale_color_discrete(breaks=c("United States","United Kingdom", "Germany", "France", 
                                  "Former USSR", "Japan")) +
    geom_vline(xintercept = 1914) +
    annotate("text", x = 1913,y = 0, label = "WWI Begins" )+ 
    geom_vline(xintercept = 1918) +
    annotate("text", x = 1919, y= 0, label = "WWI Ends" )+ 
    labs (x = "Year", y = "Real GDP Per Capita") +
    theme3

p2 <- ggplot(WW1_subset, aes(year, pop, color = country)) + geom_line() +
    ggtitle("Figure 19:1910 -1922 Population") +
    scale_x_continuous(breaks=seq(1910, 1922, 1)) +
    scale_color_discrete(breaks=c("Former USSR","United States", "Germany", "Japan",
                                  "United Kingdom", "France")) +
    geom_vline(xintercept = 1914) +
    annotate("text", x = 1913,y = 0, label = "WWI Begins" )+ 
    geom_vline(xintercept = 1918) +
    annotate("text", x = 1919, y= 0, label = "WWI Ends" ) + 
    labs (x = "Year", y = "Population") +
    theme3


p1
```



**Real GDP per capita during WWI:**

At the time of WWI, UK and US had the highest leve of real GDP per capita while Japan and USSR had the lowest.While US suffered a drop in real GDP per capita before WWI, its real GDP per capita actually increased during the war but dipped down again in 1919. UK's real GDP per capita plateaued during the war but dropped significantly after the war. Germany suffered a drop in real GDP per capita before WWI and its real GDP per capita during WWI was also at a plateau and dropped even more immediately after the war is over before finally bouncing back in 1919. Japan's real GDP per capita steadily increased from 1910 to 1922. The USSR's real GDP per capita dropped significantly during the war and stayed at the same level it was at at the end of the war until 1922. France's real GDP per capita increased until 1916 but dropped significantly during the last two years of the war before bouncing back after the war. 


```{r}
p2
```




**Population during WWI:**



It should be noted that USSR's population data is only present for the years 1913, 1920-1922. It is possible that the values are missing due to the fact that USSR wasn't a state until early 1920s. 
Population for US and Japan steadily increased from 1910 to 1922 and seems to be completely unaffected by the war. Population for Germany and UK stayed around the same during the war before dropping a little after the war.France's population dropped during the war and increased slightly after the war.


```{r}
military_expenditure_main = read.csv('data/raw/military-expenditure-as-a-share-of-gdp.csv')
colnames(military_expenditure_main)[4] <- "MilitaryExpenditure"
primary_school_main = read.csv('data/raw/primary-enrollment-selected-countries.csv')
colnames(primary_school_main)[4] <- "SchoolEnrolment"
HDI_main = read.csv('data/raw/human-development-index-escosura.csv')
colnames(HDI_main)[4] <- "HDI"
```

<!-- Intra state wars are further categorised into 3 types as follows: -->
<!-- ```{r} -->
<!-- Civil_intra_state=intra_state%>%filter(WarType==4|WarType==5) -->
<!-- Regional_internal_intra_state=intra_state%>%filter(WarType==6) -->
<!-- Intercommunal_intra_state=intra_state%>%filter(WarType==7) -->
<!-- ``` -->


#### Military expenditure trends

```{r}
#world_war1:: Years: 1914-1918
world_war1=inter_state%>%filter(WarName=='World War I')
world_war1$StateName=as.character(world_war1$StateName)
```


```{r}
#maps
world <- map_data("world")
world_war1 <- world_war1 %>%
## Recode certain entries
mutate(StateName = recode(str_trim(StateName), "United States of America" = "USA",
                            "United Kingdom" = "UK"))
```

```{r}
world_war1['start_date'] <- as.Date(with(world_war1, paste(StartYear1, StartMonth1, StartDay1,sep="-")), "%Y-%m-%d")
world_war1['end_date'] <- as.Date(with(world_war1, paste(EndYear1, EndMonth1, EndDay1,sep="-")), "%Y-%m-%d")
world_war1['number_of_days']=world_war1['end_date']-world_war1['start_date']
```







```{r message=FALSE}
# The palette with grey:
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")

military_expenditure <- subset(military_expenditure_main, Entity %in% world_war1$StateName)
  ggplot(military_expenditure,aes(Year, y = MilitaryExpenditure, colour = Entity, group = Entity)) +
  geom_line() +
  scale_color_viridis(discrete = TRUE, option = "D", breaks=c("Russia", "Germany", "Italy", "Japan", "France",
                                                              "Bulgaria", "Austria-Hungary", "Portugal", 
                                                              "Belgium", "Greece", "Romania"))+
  labs(title = "Figure 20: Trends in Military Expenditures of countries in WW1", y = "Expenditure", x = "") +
  theme(plot.title = element_text(hjust = 0.5, size=13))
    
  

military_expenditure <- subset(military_expenditure_main, Entity %in% world_war1$StateName)
military_expenditure <- subset(military_expenditure, Year >= min(world_war1$StartYear1)-10)
military_expenditure <- subset(military_expenditure, Year <= max(world_war1$EndYear1)+10)

ggplot(military_expenditure,aes(Year, y = MilitaryExpenditure, colour = Entity, group = Entity)) + 
  geom_line() +

  labs(title = "Figure 21: Trends in Military Expenditures of countries in WW1 \n (from before and after 10 years of WW1)", y = "Expenditure", x = "") +
  theme(plot.title = element_text(hjust = 0.5, size=13)) +
  scale_color_viridis(discrete = TRUE, option = "D", breaks=c("Russia", "Germany", "France", "Bulgaria", "Italy", 
                                 "Japan", "Austria-Hungary", "Portugal", "Belgium", "Greece"))

```


The above two graphs were plotted to gather insights regarding the military expenditure of the countries that were involved in world war 1. There are two graphs here - one shows the expenditure by the countries spanning over the years present in the dataset (~1825 - ~2006) and the second spans 10 years before and after the war under consideration. As one would expect, the military expenditure spiked in a very steep manner during the war years. World War 1 spanned over the years of 1914 - 1917 and we can see sharp increase in the military expenditure during these years, especially by countries like Russia, Austria-Hungary and Germany. In the first graph, we can also observe the increase in military expenditure during time periods ~1940. This time period was actually when World War 2 took place which justifies the spikes. Not surprisingly, the countries that show high increase in their military expenditure were also the most active during the wars.

These graphs are easy to read by those with colorblindness as they have been plotted using the viridis color palette.



#### Primary school enrollment percentage trends



```{r}
school_enrolment <- subset(primary_school_main, Entity %in% world_war1$StateName)
school_enrolment <- subset(school_enrolment, Year >= min(world_war1$StartYear1)-10)
school_enrolment <- subset(school_enrolment, Year <= max(world_war1$EndYear1)+10)
ggplot(school_enrolment,aes(Year, y = SchoolEnrolment, colour = Entity, group = Entity)) +
  geom_line() +
  labs(title = "Figure 22: Trends in Primary School enrolment in countries in WW1", y = "Enrolment", x = "") + 
  theme(plot.title = element_text(hjust = 0.5, size=13)) +
  scale_color_viridis(discrete = TRUE, breaks=c("France", "Japan", "Bulgaria", "Germany", "Belgium", "Greece",
                                "Romania", "Russia", "Portugal", "Italy", "Tuekey" ))
```



We wanted to explore if the education of children was starkly affected due to the world wars in the countries that actively took part in the wars. Hence, we used a dataset that contained the primary school enrolment of kids in the countries that were active in the wars. As can be clearly seen from the graph, in most of the countries, there is a downfall of the values in the time period 1914-1917. Children in countries such as Russia and Greece were severely affected. The nations' focus had surely shifted from welfare and education of kids to wars. Surprisingly, we found that the primary school enrolment in Germany was unaffected and had been increasing steadily.  


#### Human development index trends


```{r}
HDI_table <- subset(HDI_main, Entity %in% world_war1$StateName)
ggplot(HDI_table,aes(Year, y = HDI, colour = Entity)) +
  geom_line() +
  labs(title = "Figure 23: Trends in Human Development Index in countries in WW1", y = "HDI Value", x = "") +
  theme(plot.title = element_text(hjust = 0.5, size=13)) +  
  scale_color_viridis(discrete = TRUE,breaks = c("Germany", "France", "Belgium", "Japan", "Italy", 
                                  "Greece", "Portugal", "Bulgaria", "Romania", "Turkey", "Russia"))

HDI_table <- subset(HDI_table, Year >= min(world_war1$StartYear1)-15)
HDI_table <- subset(HDI_table, Year <= max(world_war1$EndYear1)+15)
ggplot(HDI_table,aes(Year, y = HDI, colour = Entity)) +
  geom_line() +

  labs(title = "Figure 24: Trends in Human Development Index in countries \n 15 years before and after WW1", y = "HDI Value", x = "") + 
  theme(plot.title = element_text(hjust = 0.5, size=13)) +
  scale_color_viridis(discrete = TRUE,breaks = c("Germany", "Belgium", "France", "Japan", "Italy",
                                  "Greece", "Bulgaria", "Romania", "Russia", "Portugal", "Turkey"))

```



The above shown plots were an attempt to analyze the affect of World War 1 on the human development index. The Human Development Index (HDI) is an index that measures key dimensions of human development. The three key dimensions are:1
– A long and healthy life – measured by life expectancy.
– Access to education – measured by expected years of schooling of children at school-entry age and mean years of schooling of the adult population.
– And a decent standard of living – measured by Gross National Income per capita (adjusted for the price level of the country.
We plotted the trends of HDI over the years present in the dataset and also near to the time period of World War 1. We found that there was no considerable effect of World War 1 on human development index.




### World War II


#### Real GDP per capita and population

```{r}
WW2_subset = WW2%>%filter(country %in% c("United States", "Former USSR", "United Kingdom", "France", "Germany", "Japan"))

p1 <- ggplot(WW2_subset, aes(year, rgdpnapc, color = country),frequency =1) + geom_line() +
    ggtitle("Figure 25:1935 - 1949 Real GDP Per Capita in 2011 US dollar") +
    scale_x_continuous(breaks=seq(1935, 1949, 1)) +
    scale_color_viridis(discrete = TRUE,breaks=c("United States","United Kingdom", "Germany", "France", 
                                  "Former USSR", "Japan")) +
    geom_vline(xintercept = 1939) +
    annotate("text", x = 1938,y = 0, label = "WWII Begins") + 
    geom_vline(xintercept = 1945) +
    annotate("text", x = 1946, y= 0, label = "WWII Ends") + 
    labs (x = "Year", y = "Real GDP Per Capita") +
    theme3

p2 <- ggplot(WW2_subset, aes(year, pop, color = country)) + geom_line() +
    ggtitle("Figure 26:1935 - 1949 Population") +
    scale_x_continuous(breaks=seq(1935, 1949, 1)) +
    scale_color_viridis(discrete = TRUE,breaks=c("Former USSR","United States", "Japan", "Germany", 
                                  "United Kingdom", "France")) +
    geom_vline(xintercept = 1939) +
    annotate("text", x = 1938,y = 0, label = "WWII Begins" )+ 
    geom_vline(xintercept = 1945) +
    annotate("text", x = 1946, y= 0, label = "WWII Ends")+ 
    labs (x = "Year", y = "Population") +
    theme3

p1
```



**Real GDP per capita during WWII:**

Real GDP per capita for Germany, U.S. and U.K. were very similar in 1935 and they were the countreis with the highest real GDP per capita. During most part of WWII real GDP per capita for those three increased steadily, while all dropping towards the end of the war with different magnitude of the drop. Germany experienced a significant drop in real GDP per capita, where it dropped to only 1/3 of where it was at starting from 1944. France also experienced a significant drop in real GDP per capita at the start of the war, at the end of the war, it dropped to only 1/2 of where it was at before war. 

```{r}
p2
```


**Population during WWII:**

While USSR had the highest population among the 6 countries, it also experienced the decrease in population after the war starts. Germany and France also experienced a drop in population after the war starts but the magnitude of the drop isn't as significant as that of USSR. Population for US and Japan increased steadily over the period 1935-1949 while population for UK stayed around the same. All countries‘ population went back to increasing about one year after the war ends. 


**Comparison between WWI and WWII:**

WWII seems to have a greater negative effect on real GDP per capita for countries like Germany and France as we can see from the size of the drop, wile GDP per capita for U.S. increased more during WWII than WWI. WWI and WWII seem to have similar effects on population for countries except for former USSR. Since most population data for USSR during the WWI is missing, it's impossible for us the make comparision on how the effects of WWI and WWII differ on USSR's population. It's quite surprising that population in most countries don't seem to be affected by the wars, for example, Japan's population steadily increased during both wars.



```{r}
#world_war2:: Years: 1939-1945
world_war2=inter_state%>%filter(WarName=='World War II')
world_war2$StateName=as.character(world_war2$StateName)
#maps
world <- map_data("world")
world_war2 <- world_war2 %>%
  ## Recode certain entries
  mutate(StateName = recode(str_trim(StateName), "United States of America" = "USA",
                            "United Kingdom" = "UK"))

```

#### Military expenditure trends

```{r}

military_expenditure <- subset(military_expenditure_main, Entity %in% world_war2$StateName)
  ggplot(military_expenditure,aes(Year, y = MilitaryExpenditure, colour = Entity, group = Entity)) +
  geom_line() +
   scale_color_viridis(discrete = TRUE, option = "D") +
  labs(title = "Figure 27: Trends in Military Expenditures of countries in WW2", y = "Expenditure", x = "") +
    theme(plot.title = element_text(hjust = 0.5, size=13))
  

military_expenditure <- subset(military_expenditure_main, Entity %in% world_war2$StateName)
military_expenditure <- subset(military_expenditure, Year >= min(world_war2$StartYear1)-10)
military_expenditure <- subset(military_expenditure, Year <= max(world_war2$EndYear1)+10)
 ggplot(military_expenditure,aes(Year, y = MilitaryExpenditure, colour = Entity, group = Entity)) +
   scale_color_viridis(discrete = TRUE, option = "D")+
  geom_line() +

  labs(title = "Figure 28: Trends in Military Expenditures of countries in WW2 \n (from before and after 10 years of WW2)", y = "Expenditure", x = "") +
   theme(plot.title = element_text(hjust = 0.5, size=13))


```

The above two are plots of military expenditure trends of countries involved in World War 2, similar to the one for World War 1. First plot shows the expenditure from 1820s - 2006 and the second shows near to the time period of world war 2. We can see sharp increase in military expenditures of certain countries such as Italy, France, etc. There are some lines which are no continuous which correspond to missing data. Certain military expenditures data are not present in the dataset used. 


#### Primary school enrolment percentage trends


```{r}
school_enrolment <- subset(primary_school_main, Entity %in% world_war2$StateName)
school_enrolment <- subset(school_enrolment, Year >= min(world_war2$StartYear1)-10)
school_enrolment <- subset(school_enrolment, Year <= max(world_war2$EndYear1)+10)
ggplot(school_enrolment,aes(Year, y = SchoolEnrolment, colour = Entity, group = Entity)) +
   scale_color_viridis(discrete = TRUE, option = "D")+
  geom_line() +
  labs(title = "Figure 29: Trends in Primary School enrolment in countries in WW2", y = "Enrolment", x = "") +
  theme(plot.title = element_text(hjust = 0.5, size=13))
```

To explore the effects of World War 2 over children's education, the above graph was plotted. In contrast with the graph of World War 1, this graph concerning countries involved in World War 2 does not show clear and significant patterns.Certain countries like China and Canada saw an increase in primary school enrollment whereas some other countries like Australia and Italy saw a decrease.



#### Human development index trends
```{r}
HDI_table <- subset(HDI_main, Entity %in% world_war2$StateName)
ggplot(HDI_table,aes(Year, y = HDI, colour = Entity)) +
   scale_color_viridis(discrete = TRUE, option = "D")+
  geom_line() +
  labs(title = "Figure 30: Trends in Human Development Index in countries in WW2", y = "HDI Value", x = "") +
  theme(plot.title = element_text(hjust = 0.5, size=13))

HDI_table <- subset(HDI_table, Year >= min(world_war2$StartYear1)-10)
HDI_table <- subset(HDI_table, Year <= max(world_war2$EndYear1)+10)
ggplot(HDI_table,aes(Year, y = HDI, colour = Entity)) +
   scale_color_viridis(discrete = TRUE, option = "D")+
  geom_line() +
  labs(title = "Figure 31: Trends in Human Development Index in countries \n 5 years before and after WW2", y = "HDI Value", x = "") +
  theme(plot.title = element_text(hjust = 0.5, size=13))

```


Similar to the results observed in the graph of HDI for countries involved in World War I, here as well there are no observable or clear patterns to the changes in HDI for the time period of World War II. 
